within ElectrolyteMedia.Media.LiquidPhase.Common.Functions.GibbsExcess.Pitzer.Solute;
function calc_b "Unsymmetrical mixing, Pitzer p.124"
  input Real x;
  output Real b[23];
protected
  parameter Real [21] a_1 = {1.925154014814667,-0.060076477753119,-0.029779077456514,-0.007299499690937,0.000388260636404,0.000636874599598,0.000036583601823,-0.000045036975204,-0.000004537895710,0.000002937706971,0.000000396566462,-0.000000202099617,-0.000000025267769,0.000000013522610,0.000000001229405,-0.000000000821969,-0.000000000050847,0.000000000046333,0.000000000001943,-0.000000000002563,-0.000000000010991};
  parameter Real [21] a_2 = {0.628023320520852,0.462762985338493,0.150044637187895,-0.028796057604906,-0.036552745910311,-0.001668087945272,0.006519840398744,0.001130378079086,-0.000887171310131,-0.000242107641309,0.000087294451594,0.000034682122751,-0.000004583768938,-0.000003548684306,-0.000000250453880,0.000000216991779,0.000000080779570,0.000000004558555,-0.000000006944757,-0.000000002849257,0.000000000237816};
  Real z;
  Integer i;
algorithm

  z :=calc_z(x);

  if x < 1 then
    for j in 1:21 loop
      i :=22 - j;
      b[i] :=z*b[i + 1] - b[i + 2] + a_1[i];
    end for;
  else
    for j in 1:21 loop
      i :=22 - j;
      b[i] :=z*b[i + 1] - b[i + 2] + a_2[i];
    end for;
  end if;

end calc_b;
